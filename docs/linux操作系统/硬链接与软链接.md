## 一、硬链接
### 1.inode和block
文件包含两部分数据：文件属性和实际内容，属性放在inode中，实际内容放在data block中。还有个超级区块（superblock）记录整个文件系统的整体信息，包括inode和block的总量，使用量，剩余量等。

![](https://cdn.nlark.com/yuque/0/2024/png/40599201/1708945548120-929ed008-c2aa-425b-ad11-4cdb11807241.png)

文件数据包含：文件属性（容量，时间，权限等）和文件实际内容

**文件系统各区块：**

+ inode:记录文件属性(类型，时间，容量)和此文件数据所在的block号码（这种通过inode可以找到block的方式称索引式文件系统），一个文件占用一个inode
+ block:记录实际内容，若文件太大会占用多个block
+ superblock：记录文件系统整体信息，包括inode/block的总量、使用量、剩余量等（文件系统的挂载时间、最近写入数据实际等相关信息）

  
**目录**的block存储什么？

+ 目录下的**<font style="color:#DF2A3F;">文件名</font>**
+ 文件名对应的inode（inode不记录文件名）

inode存：目录的属性和对应的block号

  

假设：文件夹/bin下面有两个文件：a.c和b.c，读取这两个文件的流程：

![](https://cdn.nlark.com/yuque/0/2024/png/40599201/1708946072387-0a8570d7-ea22-46ca-97ad-1bd7c3ae1404.png)

### 2.原理与用法
**<font style="color:#DF2A3F;">硬链接</font>**，Hard Link（实体链接），就是给文件起个**<font style="color:#DF2A3F;">别名</font>**。硬链接和源文件除了文件名外其相关信息都一样。创建一个硬链接不占空间只会增加一条记录，不能跨系统创建。

```objectivec
ln 源文件 目标文件
#先ls -il展示源文件的inode和硬链接计数，在源文件不同的目录下创建硬链接
ls -il day3/a.txt
ln -il day3/a.txt day4/b.txt
--第二个字段由1变成2，这个字段的含义：有多少文件名链接到这个inode（硬链接计数）
```

可以通过 day3或 day4目录的inode所指向的block 找到两个不同的文件名，两个不同的文件名都指向同一个inode，并读取到文件的实际内容。无论通过哪一个文件名对文件进行编辑，结果都会写入到同一个inode和block中。

  
**创建硬链接会改变inode或block的数量吗?**

创建硬链接没有真正创建一个文件，只是在**目录的 block中加了一个关联数据**（一个文件名和一个inode号），通常不会增加 inode和block的数量。(当目录的block被填满时，还是会新增一个block，一般硬链接用掉的关联数据很小，所以通常不会增加block)

  

  
![](https://cdn.nlark.com/yuque/0/2024/png/40599201/1709123548626-8146607c-b1d3-44d2-b078-e9a1b319df37.png)

表示：有多少个文件指向同一个inode

  

### 3.特点
+ 一般不会增加inode和block，不占空间
+ 不能跨文件系统
+ 不能链接目录（目录树可能产生环)
+ 对硬链接进行读写等操作时，操作的是源文件
+ 删除硬链接或源文件，不影响相同inode的其他文件

  
什么时候真正删除文件?

删除时，硬链接计数减一，减为0时，inode节点被释放。

  

## 二、软链接
### 1.原理与用法
Symbolic Link(符号链接)，建立一个独立文件，这个文件会让数据的读写指向它链接的文件(**存它链接文件的路径**)。但删除链接文件时，系统仅仅删除链接文件，而不删除源文件本身。当源文件被删除后，软连接也不能打开了。软连接相当于快捷方式。

```objectivec
ln -s 原文件 目标文件
```

源文件和软链接指向不同的inode

  
软链接移动到其他目录下，是否还能找到源文件?

(源文件使用绝对路径，展示软链接占的不同大小)

  

**<font style="color:rgb(77, 77, 77);">软链接，链接源文件没有了，链接文件相当于找不到家了，无法正常使用；而硬链接由于是以副本形式存在，链接源文件没有了，仍旧可以正常使用。</font>**

### 2.特点
+ 相当于**快捷方式**
+ 存文件路径，软链接文件很小
+ 使用绝对路径（存相对路径的话源文件一旦移动就找不到了）
+ 对软链接进行读写操作，系统会自动转换为对源文件的操作（删除链接文件时，删除的是链接文件，不是源文件)
+ 软链接的权限是满的，真正的权限取决于源文件
+ 源文件被删除，软链接无法访问



































